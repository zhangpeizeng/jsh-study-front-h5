<template>  <div style="padding-top: 40px;height: 100%">    <van-pull-refresh      v-model="isPullLoading"      @refresh="onRefresh"      class="pull-warp"      success-text="加载成功"    >      <!--      待考-->      <div v-show="selectStatus === 1" class="content-list">        <div class="list-item" v-for="(item, index) in unTestList" :key="index">          <div class="item-top">            <div class="bodypic">              <img v-if="item.courseImg" :src="item.courseImg" />              <img                v-if="!item.courseImg"                src="../../../../assets/images/default.png"              />            </div>            <div style="display: inline-block;vertical-align:top;">              <div class="item-title" @click="goToCourseDatil(item)">                <img                  v-if="item.courseType === '2'"                  style="width: 26px;height: 15px;vertical-align: middle"                  src="@/assets/images/icon-live.png"                  alt=""                />                <img                  v-if="item.courseType === '3'"                  style="width: 26px;height: 15px;vertical-align: middle"                  src="@/assets/images/icon-discuss.png"                  alt=""                />                <img                  v-if="item.courseType === '4'"                  style="width: 26px;height: 15px;vertical-align: middle"                  src="@/assets/images/icon-series.png"                  alt=""                />                {{ item.courseName }}              </div>              <div style="height: 23px;line-height: 23px;">                <span class="lecturer">                  <img                    style="width: 13px;height: 12px;margin-right: 4px"                    src="../../../../assets/images/icon-teacher.png"                    alt=""                  />                  {{ item.lecturerName }}</span                >                <span                  v-if="item.showButton"                  class="item-button"                  @click="goToExam(item.courseId, item.examJoinid)"                  >去考试</span                >              </div>            </div>            <div class="body-right" @click="goToCourseDatil(item)">              <img                class="right-img"                src="../../../../assets/images/arrow-right.png"                alt=""              />            </div>          </div>          <div style="clear: both;"></div>          <div class="fs-12 mt-10">            <span style="color: #646566">考试时间：</span>            <span              v-if="                handleYear(item.examStartTime) !== handleYear(item.examEndTime)              "              style="color: #969799"              >{{ item.examStartTime | date("yyyy-MM-dd hh:mm") }}至{{                item.examEndTime | date("yyyy-MM-dd hh:mm")              }}</span            >            <span v-else style="color: #969799"              >{{ item.examStartTime | date1("yyyy-MM-dd hh:mm") }}至{{                item.examEndTime | date1("yyyy-MM-dd hh:mm")              }}</span            >          </div>        </div>      </div>      <!--      缺考-->      <van-list        v-model="listDataLoading2"        :finished="listDataFinished2"        :finished-text="noExamList.length > 3 ? '没有更多了' : ''"        @load="onLoadListData2"        v-show="(noExamList.length > 0 || page2 === 0) && selectStatus === 2"      >        <div class="content-list">          <div            class="list-item"            v-for="(item, index) in noExamList"            :key="index"          >            <div class="item-top">              <div class="bodypic">                <img v-if="item.courseImg" :src="item.courseImg" />                <img                  v-if="!item.courseImg"                  src="../../../../assets/images/default.png"                />              </div>              <div style="display: inline-block;vertical-align:top;">                <div class="item-title" @click="goToCourseDatil(item)">                  <img                    v-if="item.courseType === '2'"                    style="width: 26px;height: 15px;vertical-align: middle"                    src="@/assets/images/icon-live.png"                    alt=""                  />                  <img                    v-if="item.courseType === '3'"                    style="width: 26px;height: 15px;vertical-align: middle"                    src="@/assets/images/icon-discuss.png"                    alt=""                  />                  <img                    v-if="item.courseType === '4'"                    style="width: 26px;height: 15px;vertical-align: middle"                    src="@/assets/images/icon-series.png"                    alt=""                  />                  {{ item.courseName }}                </div>                <div style="height: 23px;line-height: 23px;">                  <span class="lecturer"                    ><img                      style="width: 13px;height: 12px;margin-right: 4px"                      src="../../../../assets/images/icon-teacher.png"                      alt=""                    />{{ item.lecturerName }}</span                  >                  <!--                  <span style="margin-right: -13px;" class="no-btn-submit"-->                  <!--                    >缺考-->                  <!--                  </span>-->                  <span                    v-if="item.fillTest === 1"                    class="item-button"                    @click="goToExam(item.courseId, item.examJoinid)"                    >补考</span                  >                </div>              </div>              <div class="body-right" @click="goToCourseDatil(item)">                <img                  class="right-img"                  src="../../../../assets/images/arrow-right.png"                  alt=""                />              </div>            </div>            <div style="clear: both;"></div>            <div class="fs-12 mt-10">              <span style="color: #646566">考试时间：</span>              <span                v-if="                  handleYear(item.examStartTime) !==                    handleYear(item.examEndTime)                "                style="color: #969799"                >{{ item.examStartTime | date("yyyy-MM-dd hh:mm") }}至{{                  item.examEndTime | date("yyyy-MM-dd hh:mm")                }}</span              >              <span v-else style="color: #969799"                >{{ item.examStartTime | date1("yyyy-MM-dd hh:mm") }}至{{                  item.examEndTime | date1("yyyy-MM-dd hh:mm")                }}</span              >            </div>          </div>        </div>      </van-list>      <!--已考-->      <van-list        v-model="listDataLoading"        :finished="listDataFinished"        :finished-text="testList.length > 3 ? '没有更多了' : ''"        @load="onLoadListData"        v-show="(testList.length > 0 || page === 0) && selectStatus === 3"      >        <div class="content-list">          <div class="list-item" v-for="(item, index) in testList" :key="index">            <div class="item-top">              <div class="bodypic">                <img v-if="item.courseImg" :src="item.courseImg" />                <img                  v-if="!item.courseImg"                  src="../../../../assets/images/default.png"                />              </div>              <div style="display: inline-block;vertical-align:top;">                <div class="item-title" @click="goToCourseDatil(item)">                  <img                    v-if="item.courseType === '2'"                    style="width: 26px;height: 15px;vertical-align: middle"                    src="@/assets/images/icon-live.png"                    alt=""                  />                  <img                    v-if="item.courseType === '3'"                    style="width: 26px;height: 15px;vertical-align: middle"                    src="@/assets/images/icon-discuss.png"                    alt=""                  />                  <img                    v-if="item.courseType === '4'"                    style="width: 26px;height: 15px;vertical-align: middle"                    src="@/assets/images/icon-series.png"                    alt=""                  />                  {{ item.courseName }}                </div>                <div style="height: 23px;line-height: 23px;">                  <span class="lecturer"                    ><img                      style="width: 13px;height: 12px;margin-right: 2px"                      src="../../../../assets/images/icon-teacher.png"                      alt=""                    />{{ item.lecturerName }}</span                  >                  <span                    class="btn-submit"                    @click="goToExam(item.courseId, item.examJoinid)"                    style="font-weight: 500;margin-right: -13px;"                    >{{ item.examTotalValue }}分 >                  </span>                </div>              </div>              <div class="body-right" @click="goToCourseDatil(item)">                <img                  class="right-img"                  src="../../../../assets/images/arrow-right.png"                  alt=""                />              </div>            </div>            <div style="clear: both;"></div>            <div class="fs-12 mt-10">              <span style="color: #646566">考试时间：</span>              <span                v-if="                  handleYear(item.examStartTime) !==                    handleYear(item.examEndTime)                "                style="color: #969799"                >{{ item.examStartTime | date("yyyy-MM-dd hh:mm") }}至{{                  item.examEndTime | date("yyyy-MM-dd hh:mm")                }}</span              >              <span v-else style="color: #969799"                >{{ item.examStartTime | date1("yyyy-MM-dd hh:mm") }}至{{                  item.examEndTime | date1("yyyy-MM-dd hh:mm")                }}</span              >            </div>          </div>        </div>      </van-list>      <!--未达标-->      <van-list        v-model="listDataLoading3"        :finished="listDataFinished3"        :finished-text="noStandardList.length > 3 ? '没有更多了' : ''"        @load="onLoadListData"        v-show="          (noStandardList.length > 0 || page3 === 0) && selectStatus === 4        "      >        <div class="content-list">          <div            class="list-item"            v-for="(item, index) in noStandardList"            :key="index"          >            <div class="item-top">              <div class="bodypic">                <img v-if="item.courseImg" :src="item.courseImg" />                <img                  v-if="!item.courseImg"                  src="../../../../assets/images/default.png"                />              </div>              <div style="display: inline-block;vertical-align:top;">                <div class="item-title" @click="goToCourseDatil(item)">                  <img                    v-if="item.courseType === '2'"                    style="width: 26px;height: 15px;vertical-align: middle"                    src="@/assets/images/icon-live.png"                    alt=""                  />                  <img                    v-if="item.courseType === '3'"                    style="width: 26px;height: 15px;vertical-align: middle"                    src="@/assets/images/icon-discuss.png"                    alt=""                  />                  <img                    v-if="item.courseType === '4'"                    style="width: 26px;height: 15px;vertical-align: middle"                    src="@/assets/images/icon-series.png"                    alt=""                  />                  {{ item.courseName }}                </div>                <div style="height: 23px;line-height: 23px;">                  <span class="lecturer"                    ><img                      style="width: 13px;height: 12px;margin-right: 4px"                      src="../../../../assets/images/icon-teacher.png"                      alt=""                    />{{ item.lecturerName }}</span                  >                  <span                    v-if="item.fillTest === 4"                    class="btn-submit"                    @click="goToExam(item.courseId, item.examJoinid)"                    style="font-weight: 500;margin-right: -13px;"                    >{{ item.examTotalValue }}分 >                  </span>                  <span                    v-if="item.fillTest === 1"                    class="item-button"                    @click="goToExam(item.courseId, item.examJoinid)"                    >补考</span                  >                </div>              </div>              <div class="body-right" @click="goToCourseDatil(item)">                <img                  class="right-img"                  src="../../../../assets/images/arrow-right.png"                  alt=""                />              </div>            </div>            <div style="clear: both;"></div>            <div v-if="item.fillTestStatus === 1" class="fs-12 mt-10">              <span style="color: #646566">补考时间：</span>              <span                v-if="                  handleYear(item.fillTestStartTime) !==                    handleYear(item.fillTestEndTime)                "                style="color: #969799"                >{{ item.fillTestStartTime | date("yyyy-MM-dd hh:mm") }}至{{                  item.fillTestEndTime | date("yyyy-MM-dd hh:mm")                }}</span              >              <span v-else style="color: #969799"                >{{ item.fillTestStartTime | date1("yyyy-MM-dd hh:mm") }}至{{                  item.fillTestEndTime | date1("yyyy-MM-dd hh:mm")                }}</span              >            </div>            <div v-else class="fs-12 mt-10">              <span style="color: #646566">考试时间：</span>              <span                v-if="                  handleYear(item.examStartTime) !==                    handleYear(item.examEndTime)                "                style="color: #969799"                >{{ item.examStartTime | date("yyyy-MM-dd hh:mm") }}至{{                  item.examEndTime | date("yyyy-MM-dd hh:mm")                }}</span              >              <span v-else style="color: #969799"                >{{ item.examStartTime | date1("yyyy-MM-dd hh:mm") }}至{{                  item.examEndTime | date1("yyyy-MM-dd hh:mm")                }}</span              >            </div>          </div>        </div>      </van-list>    </van-pull-refresh>    <!--    <van-action-sheet v-model="show" title="考试">-->    <!--      <div style="height: 460px;">-->    <!--        <iframe-->    <!--          :src="testUrl"-->    <!--          :style="{ height: '100%', width: '100%' }"-->    <!--          frameborder="0"-->    <!--          border="0"-->    <!--        ></iframe>-->    <!--      </div>-->    <!--    </van-action-sheet>-->    <van-action-sheet v-model="scoreshow" title="考试结果">      <div style="height: 460px;">        <iframe          :src="scoreUrl"          :style="{ height: '100%', width: '100%' }"          frameborder="0"          border="0"        ></iframe>      </div>    </van-action-sheet>    <div      class="no-list"      v-if="        (unTestList.length === 0 && selectStatus === 1) ||          (testList.length === 0 && selectStatus === 3) ||          (noExamList.length === 0 && selectStatus === 2) ||          (noStandardList.length === 0 && selectStatus === 4)      "    >      <div style="margin-top: 160px;">        <img src="../../../../assets/images/no-search-data.png" alt="" />        <span style="padding-top: 10px;display: block;"          >暂无课程，先学习其他课程吧~</span        >      </div>    </div>    <div class="no-network" v-if="isFlag">      <div>        <div class="set">          <div>            <img src="@/assets/images/network.png" alt="" />          </div>          <div style="padding-top: 30px;color: #646566;font-size: 14px">            网络请求失败          </div>          <div style="padding-top: 10px">请检查您的网络，重新加载试试吧</div>          <div class="refresh" @click="onRefresh">刷新</div>        </div>      </div>    </div>  </div></template><script>import Vue from "vue";import {  Toast,  NavBar,  Cell,  CellGroup,  List,  PullRefresh,  ActionSheet,  Popup,  Icon} from "vant";import { CloudMarketing } from "@/request";import JSH from "@/core";Vue.use(NavBar);Vue.use(Cell);Vue.use(CellGroup);Vue.use(List);Vue.use(PullRefresh);Vue.use(Popup);Vue.use(Icon);Vue.use(Toast);Vue.use(ActionSheet);export default {  name: "test-list",  comments: {},  props: ["selectStatus"],  data() {    return {      scoreUrl: null,      flag: 1,      testUrl: "",      show: false,      scoreshow: false,      totalNumber: null,      testName: "",      unTestList: [],      isFlag: false,      testList: [],      noExamList: [],      noStandardList: [], // 未达标列表      total: null,      isPullLoading: false, // 下拉刷新      listDataLoading: false, // 上拉加载      listDataFinished: false, // 上拉加载数据完成      page: 1, // 页数      isPullLoading2: false, // 下拉刷新      listDataLoading2: false, // 上拉加载      listDataFinished2: false, // 上拉加载数据完成      page2: 1, // 页数      isPullLoading3: false, // 未达标下拉刷新      listDataLoading3: false, // 未达标上拉加载      listDataFinished3: false, // 未达标上拉加载数据完成      page3: 1 // 未达标页数    };  },  methods: {    handleYear(data) {      let date = new Date(data);      return date.getFullYear();    },    //问卷星    goToExam(courseId, examJoinid) {      const owner = this;      JSH.request({        url: CloudMarketing.getexamurl,        method: "get",        params: { baseId: courseId, examJoinid: examJoinid, type: 1 },        success(data) {          if (data.success) {            owner.testUrl = "";            owner.testUrl = data.data;            // owner.show = true;            // owner.scoreshow = false;            owner.$router.push({              path: "/public/examQuestions",              query: {                testUrl: owner.testUrl              }            });          } else {            owner.show = false;            Toast(data.errorMsg);          }        },        error() {          console.log("服务器错误");        }      });    },    //已考    goToExamResult(id, examJoinid) {      const owner = this;      JSH.request({        url: CloudMarketing.getexamresulturl,        method: "get",        params: {          examId: id,          examJoinid: examJoinid        },        success(data) {          if (data.success) {            owner.scoreUrl = "";            owner.scoreUrl = data.data;            owner.show = false;            owner.scoreshow = true;          } else {            owner.scoreshow = false;            Toast(data.errorMsg);          }        },        error() {          owner.isFlag = true;        }      });    },    //跳转到课程详情    goToCourseDatil(obj) {      if (obj.status == 1 || obj.status == 3 || obj.deleteFlg == 1) {        this.$toast(          "哎哟，已错过课程学习时间，下次早点来呀，你可以先学习其他课程"        );        return;      }      if (obj.studyWarningMsg) {        this.$toast(obj.studyWarningMsg);        return;      } else {        let url = "";        if (obj.courseType == 1) {          url = "/public/recorded-course";        } else if (obj.courseType == 2) {          url = "/public/live-course";        } else if (obj.courseType == 3) {          url = "/public/discussion-course";        } else {          url = "/public/series-course";        }        this.$router.push({          path: url,          query: {            id: obj.courseId          }        });      }    },    //考试部分未完成    getExaminationList() {      let owner = this;      JSH.request({        url: CloudMarketing.homeworktaskTest,        method: "get",        params: {},        success(data) {          if (data.success) {            owner.unTestList = data.data;            owner.totalNumber = data.data.length;            console.log(owner.testList);          } else {            owner.unTestList = [];            owner.isFlag = false;          }        },        error() {          owner.isFlag = true;        }      });    },    //考试已完成    getTestFinshLIst(page, callback) {      const owner = this;      //查询留言列表      JSH.request({        url: CloudMarketing.homeworkTestFinish,        method: "get",        params: {          pageNum: page,          pageSize: 10        },        success(res) {          console.log(res);          if (res.success) {            callback(res);            // 赋值分页            owner.page = page;            // 数据是否加载完成            owner.listDataFinished = owner.page >= res.data.pages;          } else {            owner.page = 1;            owner.testList = [];            owner.isFlag = false;          }        },        error() {          owner.isFlag = true;        }      });    },    //考试缺考    getUnTestFinshLIst(page, callback) {      const owner = this;      owner.ht.$emit("loading", true);      //查询留言列表      JSH.request({        url: CloudMarketing.unExamfinishAbandon,        method: "get",        params: {          pageNum: page,          pageSize: 10        },        success(res) {          console.log(res);          owner.ht.$emit("loading", false);          if (res.success) {            callback(res);            // 赋值分页            owner.page = page;            // 数据是否加载完成            owner.listDataFinished2 = owner.page >= res.data.pages;          } else {            owner.page = 1;            owner.testList = [];            owner.isFlag = false;          }        },        error() {          owner.isFlag = true;          owner.ht.$emit("loading", false);        }      });    },    //考试未达标列表    notUpToStandard(page, callback) {      const owner = this;      //查询留言列表      JSH.request({        url: CloudMarketing.listExamsByAccountIdFail,        method: "get",        params: {          pageNum: page,          pageSize: 10        },        success(res) {          console.log(res);          if (res.success) {            callback(res);            // 赋值分页            owner.page3 = page;            // 数据是否加载完成            owner.listDataFinished3 = owner.page3 >= res.data.pages;          } else {            owner.page3 = 1;            owner.noStandardList = [];            owner.isFlag = false;          }        },        error() {          owner.isFlag = true;        }      });    },    //下拉刷新方法    onRefresh() {      const owner = this;      this.getTestFinshLIst(1, data => {        owner.isPullLoading = false;        owner.testList = data.data.list;      });      owner.getExaminationList();      this.getUnTestFinshLIst(1, data => {        owner.isPullLoading2 = false;        owner.noExamList = data.data.list;      });      this.notUpToStandard(1, data => {        owner.isPullLoading3 = false;        owner.noStandardList = data.data.list;      });    },    //列表数据加载方法    onLoadListData() {      const owner = this;      this.getTestFinshLIst(this.page + 1, data => {        // 加载状态结束        owner.listDataLoading = false;        console.log(data);        owner.testList = owner.testList.concat(data.data.list);      });    },    //列表数据加载方法    onLoadListData2() {      const owner = this;      this.getUnTestFinshLIst(this.page2 + 1, data => {        // 加载状态结束        owner.listDataLoading2 = false;        console.log(data);        owner.noExamList = owner.noExamList.concat(data.data.list);      });    }  },  watch: {    totalNumber(val) {      this.$emit("getDataFromL", val);    },    selectStatus(val) {      setTimeout(() => {        document.documentElement.scrollTop = 0;      }, 100);      let owner = this;      console.log("1");      if (val === 1) {        this.getExaminationList();      } else if (val === 2) {        this.getUnTestFinshLIst(1, data => {          owner.isPullLoading2 = false;          owner.noExamList = data.data.list;        });      } else if (val === 3) {        this.getTestFinshLIst(1, data => {          owner.isPullLoading = false;          owner.testList = data.data.list;        });      }    }  },  created() {    const owner = this;    owner.onRefresh();  },  activated() {    const owner = this;    owner.onRefresh();  }};</script><style scoped>/deep/.van-pull-refresh__track {  position: relative;  height: 100%;  -webkit-transition-property: -webkit-transform;  transition-property: -webkit-transform;  transition-property: transform;  transition-property: transform, -webkit-transform;  min-height: 500px;}</style><style lang="scss" scoped>.content-top {  color: #969799;  font-size: 14px;  padding-left: 20px;  width: 375px;  height: 34px;  line-height: 34px;}.no-list {  text-align: center;  position: absolute;  margin: 0 auto;  margin-top: -500px;  min-height: 700px;  width: 100%;  background-color: white;  img {    width: 67px;    height: 49px;  }  font-size: 13px;  font-family: PingFangSC-Regular, PingFang SC;  font-weight: 400;  color: rgba(153, 153, 153, 1);}.content-list {  width: 100%;  .list-item {    background-color: #ffffff;    border-radius: 10px;    padding: 10px;    margin: 10px 10px 0px 10px;    .item-top {      position: relative;      .bodypic {        width: 144px;        height: 90px;        margin-right: 10px;        float: left;        img {          width: 100%;          height: 100%;          border-radius: 6px;        }      }      .body-right {        display: inline-block;        width: 14px;        text-align: right;        vertical-align: top;      }      .right-img {        margin-top: 3px;        width: 7px;        height: 10px;        vertical-align: top;      }      .item-title {        min-height: 40px;        font-size: 14px;        color: #323233;        width: 161px;        word-wrap: break-word;        word-break: break-all;        text-overflow: ellipsis;        display: -webkit-box;        -webkit-line-clamp: 3;        -webkit-box-orient: vertical;        overflow: hidden;      }      .item-title-pk {        font-size: 14px;        color: #323233;        width: 215px;        text-align: left;      }      .item-tname {        font-size: 13px;        color: #7d7e80;        text-align: left;        margin-top: 6px;      }      .item-tname-pk {        position: absolute;        bottom: 5px;        left: 130px;        font-size: 13px;        color: #7d7e80;        text-align: left;      }      .item-button {        position: absolute;        right: 0;        border: 1px solid #2780f8;        width: 70px;        height: 22px;        line-height: 22px;        color: #2780f8;        border-radius: 15px;        text-align: center;        font-size: 14px;      }      .btn-submit {        color: #227ef7;        font-size: 14px;        float: right;      }      .no-btn-submit {        font-size: 14px;        float: right;        font-family: PingFangSC-Regular, PingFang SC;        font-weight: 400;        color: rgba(125, 126, 128, 1);        background: rgba(242, 243, 245, 1);        border-radius: 30px;        padding: 2px 15px;      }      .lecturer {        font-size: 13px;        color: #7d7e80;      }      .item-button-pk {        /*position: absolute;*/        bottom: 0;        right: 0;        background-color: #f2f3f5;        color: #7d7e80;        font-size: 14px;        width: 72px;        height: 24px;        line-height: 24px;        border-radius: 15px;        text-align: center;        float: right;      }      .score {        position: absolute;        bottom: 5px;        right: 0;        font-size: 16px;        font-weight: 500;        color: #227ef7;        img {          margin-left: 5px;          width: 7px;          height: 10px;        }      }    }  }}.no-network {  padding-top: 83px;  text-align: center;  position: fixed;  width: 100%;  height: 100%;  background: white;  .refresh {    display: inline-block;    font-size: 14px;    font-family: PingFangSC-Regular, PingFang SC;    font-weight: 400;    color: rgba(39, 128, 248, 1);    margin-top: 30px;    padding: 7px 35px;    border-radius: 40px;    border: 1px solid #2780f8;  }  img {    width: 100px;    height: 70px;  }  font-size: 13px;  font-family: PingFangSC-Regular, PingFang SC;  font-weight: 400;  color: rgba(150, 151, 153, 1);}</style>